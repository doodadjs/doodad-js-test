<!DOCTYPE html>
<html>
<body>
    <script async src="../../doodad-js/doodad-js_debug.js"></script>

    <!--IE8 <script>
        // <PRB> "es6-promise" needs "Array.isArray"
        if (!Array.isArray) {
            Array.isArray = function(obj) {
                return Object.prototype.toString.call(obj) === '[object Array]';
            };
        };
    </script>-->
    <script src="../../lib/es6-promise/es6-promise.min.js"></script>

    <script>
			(function() {
				"use strict";

				var __prevOnLoad__ = window.onload;
				window.onload = function onload(ev) {
					if (__prevOnLoad__) {
						__prevOnLoad__.call(this, ev);
					};

					var global = window;

					var SECRET = ((typeof Symbol === 'function') ? Symbol() : []);

					var options = {startup: {secret: SECRET}};

					options['Doodad.Modules'] = {
						modulesUri: '../..',
					};

					global.createRoot(null, options)
                        .then(function (root) {
                            var doodad = root.Doodad,
						        modules = doodad.Modules;

                            doodad.Tools.trapUnhandledErrors();

                            return modules.load({
                                'doodad-js-unicode': null,
                                'doodad-js-locale': null,
                                'doodad-js-safeeval': null,
                                'doodad-js-loader': null,
                                'doodad-js-test': {'widgets/MyWidget_loader.js': null},
                            }, options);
                        })
				        ['catch'](function (err) {
				            alert(err);
				        });
				};
			}).call((typeof global !== 'undefined') ? global : ((typeof window !== 'undefined') ? window : this));
    </script>

    <div id="test1"></div>
    <div id="test2"></div>
    <div id="test3"></div>

</body>
</html>
